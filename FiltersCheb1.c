/*******************************************************************************
 * file:	FiltrsCheb1.c
 * author:	A.Vlashchuk
 * version:	V1.0.0
 * date:	23-July-2015
 * brief:	Цифровые фильтры Чебышева - 1
 *******************************************************************************/
#include "FiltersCheb1.h"

float df2sos_LPF_100Hz_50kHzSR(float x)
{
// Коэффициенты LPF-фильтра 100Hz (3 секции SOS-II)
//	const float	b[3][3] = {	1,2,1,
//							1,2,1,
//							1,2,1};
	const float	a[3][3] = {	1, -1.9965193271636963, 0.99670696258544922,
							1, -1.9909096956253052, 0.99102872610092163,
							1, -1.9877140522003174, 0.98776489496231079};
	const float	g[4] = {0.000046907211071811616, 0.000029756702133454382, 0.000012718121979560237, 0.99426007270812988};
	// Переменные фильтра
	static float w[3][3];
	// первая секция
		w[0][2] = w[0][1];
		w[0][1] = w[0][0];
		w[0][0] = x * g[0] - w[0][1] * a[0][1] - w[0][2] * a[0][2];
		x = w[0][0] + w[0][1] + w[0][1] + w[0][2];
	// вторая секция
		w[1][2] = w[1][1];
		w[1][1] = w[1][0];
		w[1][0] = x * g[1] - w[1][1] * a[1][1] - w[1][2] * a[1][2];
		x = w[1][0] + w[1][1] + w[1][1] + w[1][2];
	// третья секция
		w[2][2] = w[2][1];
		w[2][1] = w[2][0];
		w[2][0] = x * g[2] - w[2][1] * a[2][1] - w[2][2] * a[2][2];
		x = w[2][0] + w[2][1] + w[2][1] + w[2][2];
	return x * g[3];
}

float df2sos_LPF_500Hz_50kHzSR(float x)
{
// Коэффициенты LPF-фильтра 500Hz (2 секции SOS-II)
//	const float	b[2][3] = {	1,2,1,
//							1,2,1};
	const float	a[2][3] = {	1, -1.956606388092041, 0.96237647533416748,
							1, -1.9085069894790649, 0.91146355867385864};
	const float	g[3] = {0.0014425088884308934, 0.00073914899257943034, 0.99426007270812988};
	// Переменные фильтра
	static float w[2][3];
	// первая секция
		w[0][2] = w[0][1];
		w[0][1] = w[0][0];
		w[0][0] = x * g[0] - w[0][1] * a[0][1] - w[0][2] * a[0][2];
		x = w[0][0] + w[0][1] + w[0][1] + w[0][2];
	// вторая секция
		w[1][2] = w[1][1];
		w[1][1] = w[1][0];
		w[1][0] = x * g[1] - w[1][1] * a[1][1] - w[1][2] * a[1][2];
		x = w[1][0] + w[1][1] + w[1][1] + w[1][2];
	return x * g[2];
}

float df2sos_LPF_1000Hz_50kHzSR(float x)
{
// Коэффициенты LPF-фильтра 1kHz (2 секции SOS-II)
//	const float	b[2][3] = {	1,2,1,
//							1,2,1};
	const float	a[2][3] = {	1, -1.9037837982177734, 0.92638546228408813,
							1, -1.8193182945251465, 0.83064067363739014};
	const float	g[3] = {0.005650427658110857, 0.0028305980376899242, 0.99426007270812988};
	// Переменные фильтра
	static float w[2][3];
	// первая секция
		w[0][2] = w[0][1];
		w[0][1] = w[0][0];
		w[0][0] = x * g[0] - w[0][1] * a[0][1] - w[0][2] * a[0][2];
		x = w[0][0] + w[0][1] + w[0][1] + w[0][2];
	// вторая секция
		w[1][2] = w[1][1];
		w[1][1] = w[1][0];
		w[1][0] = x * g[1] - w[1][1] * a[1][1] - w[1][2] * a[1][2];
		x = w[1][0] + w[1][1] + w[1][1] + w[1][2];
	return x * g[2];
}

float df2sos_HPF_5Hz_5kHzSR(float x)
{
// Коэффициенты HPF-фильтра 5Hz (2 секции SOS-II)
//	const float	b[2][3] = {	1,-2,1,
//							1,-2,1};
	const float	a[2][3] = {	1, -1.9974018335342407, 0.997428297996521,
							1, -1.9881936311721802, 0.98824375867843628};
	const float	g[3] = {0.99870753288269043, 0.99410933256149292, 0.99426007270812988};
	// Переменные фильтра
	static float w[2][3];
	// первая секция
		w[0][2] = w[0][1];
		w[0][1] = w[0][0];
		w[0][0] = x * g[0] - w[0][1] * a[0][1] - w[0][2] * a[0][2];
		x = w[0][0] - w[0][1] - w[0][1] + w[0][2];
	// вторая секция
		w[1][2] = w[1][1];
		w[1][1] = w[1][0];
		w[1][0] = x * g[1] - w[1][1] * a[1][1] - w[1][2] * a[1][2];
		x = w[1][0] - w[1][1] - w[1][1] + w[1][2];
	return x * g[2];
}

float df2sos_HPF_10Hz_10kHzSR(float x)
{
// Коэффициенты HPF-фильтра 10Hz (2 секции SOS-II)
//	const float	b[2][3] = {	1,-2,1,
//							1,-2,1};
	const float	a[2][3] = {	1, -1.9974018335342407, 0.997428297996521,
							1, -1.9881936311721802, 0.98824375867843628};
	const float	g[3] = {0.99870753288269043, 0.99410933256149292, 0.99426007270812988};
	// Переменные фильтра
	static float w[2][3];
	// первая секция
		w[0][2] = w[0][1];
		w[0][1] = w[0][0];
		w[0][0] = x * g[0] - w[0][1] * a[0][1] - w[0][2] * a[0][2];
		x = w[0][0] - w[0][1] - w[0][1] + w[0][2];
	// вторая секция
		w[1][2] = w[1][1];
		w[1][1] = w[1][0];
		w[1][0] = x * g[1] - w[1][1] * a[1][1] - w[1][2] * a[1][2];
		x = w[1][0] - w[1][1] - w[1][1] + w[1][2];
	return x * g[2];
}
